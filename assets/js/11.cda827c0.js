(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{218:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"deployment-with-vue-cli-pwa"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deployment-with-vue-cli-pwa"}},[t._v("#")]),t._v(" Deployment with Vue CLI, PWA")]),t._v(" "),s("h2",{attrs:{id:"deployment-with-vue-cli"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deployment-with-vue-cli"}},[t._v("#")]),t._v(" Deployment with Vue CLI")]),t._v(" "),s("p",[t._v("Webpack dev server는 Node moudles @vue cli-service에 존재한다.")]),t._v(" "),s("p",[t._v("dist 폴더를 찾다보면 hash값이 포함된 파일을 찾을 수 있는데, Hash값은 브라우저 캐시와 같은 역할을 한다.\n새로고침하더라도 기존 상태가 남아있지 않고 최신상태를 반영하기 위함.")]),t._v(" "),s("p",[t._v("Component들이 vue 파일인데, 실제 npm run serve로 올려보면 element로 tag가 생성되어 있다. 즉, app.js에서 webpack을 사용해 받아온다는 것을 확인할 수 있음.")]),t._v(" "),s("p",[t._v("static file server와 webpack dev server의 차이를 잘 알아둬야 한다.")]),t._v(" "),s("ul",[s("li",[t._v("webpack dev server 포트번호 : 8080")]),t._v(" "),s("li",[t._v("static file server(npm run serve) 포트번호 : 5000")])]),t._v(" "),s("h3",{attrs:{id:"continuous-deployment-cd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#continuous-deployment-cd"}},[t._v("#")]),t._v(" Continuous Deployment (CD)")]),t._v(" "),s("p",[t._v("지속적으로 배포하는 것. 실시간서비스나 협업 중에 유용하게 사용된다.")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.netlify.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Netlify"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("배포 자동화를 도와준다. 소스변경이 일어났을 때 자동으로 배포시켜준다.")]),t._v(" "),s("p",[t._v("Publish directory는 해당 repository를 배포할 대상 위치를 가리킨다.")]),t._v(" "),s("p",[t._v("배포 자동화를 위해 프론트 배포는 Netlify를, 백엔드 배포는 Elastic Beanstalk을 많이 사용한다.")]),t._v(" "),s("h2",{attrs:{id:"pwa-실습"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pwa-실습"}},[t._v("#")]),t._v(" PWA 실습")]),t._v(" "),s("p",[t._v("기존 프로젝트에 PWA를 추가하는 실습이다. workbox를 사용하여 실습을 진행하였다.")]),t._v(" "),s("p",[t._v("이제는 sw-precache는 구시대 기술이다. 하지만 여전히 기업들은 많이 사용한다고 한다.")]),t._v(" "),s("ol",[s("li")]),t._v(" "),s("p",[t._v("Public-index.html 에다가 추가")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("manifest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("manifest.json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li")]),t._v(" "),s("p",[t._v("public/manifest.json 생성")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://app-manifest.firebaseapp.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("manifest 자동 생성 툴"),s("OutboundLink")],1),t._v("을 사용해 manifest.json을 쉽게 생성할 수 있다.")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" workbox-cli -g\n")])])]),s("ol",{attrs:{start:"4"}},[s("li")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])])]),s("ol",{attrs:{start:"5"}},[s("li")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("workbox wizard\n")])])]),s("p",[t._v("터미널에 다음과 같은 설정 사항들이 표시될 것이다.")]),t._v(" "),s("ul",[s("li",[t._v("Wabapp의 root (어디 배포하는지) - dist/")]),t._v(" "),s("li",[t._v("precache - 필요한 파일들이 선택되었는지 보고 enter")]),t._v(" "),s("li",[t._v("서비스 워커 저장 위치 - dist/sw.js")]),t._v(" "),s("li",[t._v("설정 파일 - workbox-config.js")])]),t._v(" "),s("ol",{attrs:{start:"6"}},[s("li")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("workbox generateSW ./workbox-config.js\n")])])]),s("p",[t._v("서비스 워커가 생성되었음을 확인할 수 있다.")]),t._v(" "),s("p",[t._v("모든 이미지와 js 파일들을 service worker에서 들고 오기 때문에 PWA는 오프라인에서 작동이 가능하다.")]),t._v(" "),s("p",[t._v("서비스 워커 파일을 직접 조작하고 커스텀하기를 원한다면 아래 스크립트를 적용한다.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("workbox injectManifest ./workbox-config.js\n")])])]),s("p",[t._v("위 명령어를 실행하려고 할 때, 잘못된 swSrc 주소나, 해당 주소의 파일에 제대로 된 값이 입력되어 있지 않으면 에러가 뜬다.")]),t._v(" "),s("h2",{attrs:{id:"service-worker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#service-worker"}},[t._v("#")]),t._v(" Service Worker")]),t._v(" "),s("ul",[s("li",[t._v("브라우저의 백그라운드 실행(javascript의 UI thread와 별도의 동작)")]),t._v(" "),s("li",[t._v("네트워크 요청 가로채기 (캐시 안에 instance가 없으면 서버에 자원 요청) -> 프록시")]),t._v(" "),s("li",[t._v("브라우저 종속 생명주기")]),t._v(" "),s("li",[t._v("notification 제공")])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://www.html5rocks.com/ko/tutorials/service-worker/introduction/images/sw-lifecycle.png",alt:"서비스워커생명주기"}})]),t._v(" "),s("h2",{attrs:{id:"pwa-caching"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pwa-caching"}},[t._v("#")]),t._v(" PWA caching")]),t._v(" "),s("p",[t._v("Application tap의 cache storage")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("프리캐싱\n: 웹 애플리케이션 접속 전 미리 캐싱")])]),t._v(" "),s("li",[s("p",[t._v("런타임 캐싱\n: 발생하는 요청에 대해 캐시 스토리지 저장 - 정규식 사용하여 어떤 파일 패턴을 받을 것인지, 어떤 것들에 대해서 무조건 캐시로 받을 것인지 등등의 전략이 필요")])])]),t._v(" "),s("h3",{attrs:{id:"캐싱-전략"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#캐싱-전략"}},[t._v("#")]),t._v(" 캐싱 전략")]),t._v(" "),s("ul",[s("li",[t._v("cacheFirst (캐시를 네트워크 보다 먼저 요청할 것인지)\n"),s("ul",[s("li",[t._v("offline 페이지가 먼저 보여질 때 유리\n"),s("img",{attrs:{src:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FPpDaf%2FbtqEtFqGouu%2FS6ENcKyoHWQlo6Z19AJz5k%2Fimg.png",alt:"cacheFirst"}})])])])]),t._v(" "),s("ul",[s("li",[t._v("cacheOnly (캐시만 볼 것인지)\n"),s("ul",[s("li",[t._v("static file가 해당\n"),s("img",{attrs:{src:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbpI2II%2FbtqEuAvple1%2F2IpsVdAvUWGGfBXk9PybU1%2Fimg.png",alt:"cacheOnly"}})])])])]),t._v(" "),s("ul",[s("li",[t._v("networkFirst (캐시보다 네트워크를 먼저 요청할 것인지)\n"),s("ul",[s("li",[t._v("UX에 좋지 않음\n"),s("img",{attrs:{src:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbJsKiY%2FbtqEtuQvqpM%2FbqCImrf0BePOkhnFrYBaL1%2Fimg.png",alt:"networkFirst"}})])])])]),t._v(" "),s("ul",[s("li",[t._v("networkOnly (네트워크만 요청할 것인지)\n"),s("ul",[s("li",[t._v("캐시가 필요없는 GET 메소드가 아닌 method\n"),s("img",{attrs:{src:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FTn4km%2FbtqEuzcbs0F%2FkR0h3Q2R0wp6FHSU5Z9UaK%2Fimg.png",alt:"networkOnly"}})])])])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("staleWhileRevalidate (캐시 먼저, 그 다음 네트워크에서 요청된 캐시 반환)")]),t._v(" "),s("ul",[s("li",[t._v("주로 사용되는 방식\n"),s("img",{attrs:{src:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbAL18Z%2FbtqEu7fgGl1%2FGuwZFJcrjbPit3QmYfn3b0%2Fimg.png",alt:"staleWhileRevalidate"}})])])]),t._v(" "),s("li",[s("p",[t._v("Cache then network (캐시, 네트워크에 요청을 동시에 하고, 캐시 data 먼저 표시, 이후 네트워크 data 표시)")]),t._v(" "),s("ul",[s("li",[t._v("workbox에는 없는 전략, networkFirst보다는 UX에 좋음\n"),s("img",{attrs:{src:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcXJOhR%2FbtqEuXjBAqH%2F4B0krhd20WmGw5sNqCKUbK%2Fimg.png",alt:"Cache then network"}})])])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook",target:"_blank",rel:"noopener noreferrer"}},[t._v("Offline Cookbook"),s("OutboundLink")],1),t._v(" | "),s("a",{attrs:{href:"https://developers.google.com/web/tools/workbox/modules/workbox-strategies",target:"_blank",rel:"noopener noreferrer"}},[t._v("Workbox strategies"),s("OutboundLink")],1)])])]),t._v(" "),s("h3",{attrs:{id:"workbox-routing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#workbox-routing"}},[t._v("#")]),t._v(" Workbox routing")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("workbox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("routing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerRoute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RegExp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.example.com/(.*)'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("workbox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strategies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StaleWhileRevalidate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tcacheName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'example-cache'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tplugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("workbox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("expiration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tmaxEntries"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\tmaxAgeSeconds"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[t._v("정규 표현식과 workbox의 routing을 활용하여 해당하는 url 형식으로 요청이 들어올 경우 런타임 캐싱처리를 할 수 있다.")]),t._v(" "),s("li",[s("code",[t._v("self.addEventListener('fetch' ...")]),t._v(" 로 네트워크 가로채기를 수행하려면 registerRoute 이후에 위치시켜야 충돌이 나지 않는다.")])])])}),[],!1,null,null,null);a.default=n.exports}}]);